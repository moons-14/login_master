# DBは以下のコマンドで作成できます

```sql
CREATE TABLE `user_data` (
    `user_id` int(20) NOT NULL AUTO_INCREMENT,
    `user_name` text NOT NULL,
    `user_email` text NOT NULL,
    `email_token` text NOT NULL,
    `user_password` text NOT NULL,
    PRIMARY KEY (`user_id`),
    UNIQUE KEY `user_name` (`user_name`) USING HASH,
    UNIQUE KEY `user_email` (`user_email`) USING HASH
   ) ENGINE=InnoDB AUTO_INCREMENT=10 DEFAULT CHARSET=utf8mb4
```
# 使い方

## ユーザー認証(ログイン)

#### 1.ユーザーネームとパスワードを使って認証
```php
login_name("ログイン時に使うユーザーネーム","ログイン時に使うパスワード","DBのホスト名","DB名","DBユーザー名","DBパスワード","DBのテーブル")
```

#### 2.メールアドレスとパスワードを使って認証
```php
login_name("ログイン時に使うメールアドレス","ログイン時に使うパスワード","DBのホスト名","DB名","DBユーザー名","DBパスワード","DBのテーブル")
```

#### 3.ユーザーネームかメールアドレスとパスワードを使って認証
```php
login("ログイン時に使うメールアドレスもしくはユーザーネーム","ログイン時に使うパスワード","DBのホスト名","DB名","DBユーザー名","DBパスワード","DBのテーブル")
```

ステータスコード
200:ログインに成功しました
400:不足している引数があります
503:DBに接続できません
100:不明なエラーです
301:パスワードが違います
302:ユーザー名もしくはメールアドレスが違います

返り値
ステータスコード200の場合のみ以下の値が返ってきます
キー:値
user_name:DBに収納されているユーザーネーム
user_id:DBに収納されているユーザーID
どちらも認証に成功したユーザーの情報です

## ユーザー登録(サインアップ)

#### 1.ユーザーネームとパスワードを指定して登録
```php
signup_user("登録するユーザーネーム","登録するパスワード","DBのホスト名","DB名","DBユーザー名","DBパスワード","DBのテーブル")
```

#### 2.ユーザーネームとメールアドレスとパスワードを指定して登録(メール認証なし)
```php
signup("登録するユーザーネーム","登録するメールアドレス","登録するパスワード","DBのホスト名","DB名","DBユーザー名","DBパスワード","DBのテーブル")
```

#### 3.ユーザーネームとメールアドレスとパスワードを指定して登録(メール認証あり)
この機能を使うには2つの関数を実行する必要があります。
###### その一 仮登録し、メール認証に必要なコードを発行する
```php
signup_provisional("登録するユーザーネーム","登録するメールアドレス","登録するパスワード","DBのホスト名","DB名","DBユーザー名","DBパスワード","DBのテーブル")
```
この関数の場合成功するとステータスコード202が返ってきます
(メール認証に必要なコードをメールトークンと呼びます)
そのほかに
キー:値
email_token:メールトークン
が戻り値として返ってくるため、このコードをメールに送信するなどしてメールが受け取り可能であることを確認してください
###### その二 メールを認証し、本登録する
```php
signup_email("メールトークン","DBのホスト名","DB名","DBユーザー名","DBパスワード","DBのテーブル")
```

ステータスコード
200:ユーザー登録に成功しました
202:メールアドレスの仮登録が完了しました
400:不足か間違った型の引数があります
401:メールトークンは数字しか含まれません
502:重複したユーザーネームで登録しようとしています
504:重複したメールアドレスで登録しようとしています
503:DBに接続できません
100:不明なエラーです
302:ユーザーネームの形式が違います
303:メールアドレスの形式が違います
304:メール認証済みです
305:メールトークンが違います

返り値
ステータスコード200の場合のみ以下の値が返ってきます
メール認証無し、メール認証
キー:値
user_name:DBに収納されたユーザーネーム
user_id:DBに収納されたユーザーID
どちらも登録に成功したユーザーの情報です

メール仮登録の場合は
email_token:メールトークン
が返ってきます

## パスワードリセット

#### 1.ユーザーネームと変更後のパスワードを指定して変更
```php
password_reset("変更するユーザーネーム","変更後のパスワード","DBのホスト名","DB名","DBユーザー名","DBパスワード","DBのテーブル")
```

ステータスコード
200:パスワード変更に成功しました
400:不足か間違った型の引数があります
401:ユーザーネームが違います
503:DBに接続できません
100:不明なエラーです


返り値
ステータスコード200の場合のみ以下の値が返ってきます
キー:値
user_name:DBに収納されたユーザーネーム
user_id:DBに収納されたユーザーID
どちらも登録に成功したユーザーの情報です


# 最後に

不明な部分がある場合は [Twitter](https://twitter.com/moons14_) でご質問ください。
脆弱な部分のご指摘や軽量化等のアドバイスもお待ちしております
